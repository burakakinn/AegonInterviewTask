<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Customer Satisfaction Survey Â· Bootstrap</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- Custom styles for this template -->
    <link href="/common.css" rel="stylesheet">

    <script>
        var baseurl = "http://localhost:8080/survey";
        function loadResults(){
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("GET",baseurl + "/getResults",true);
            xmlhttp.onreadystatechange = function() {
                if(xmlhttp.readyState ===4 && xmlhttp.status ===200){
                    var results = JSON.parse(xmlhttp.responseText);
                    var tbltop = `<table class="table"><thead>
			    <tr><th scope="col">TOPIC ID</th><th scope="col">TOPIC</th><th scope="col">NPM SCORE</th></tr></thead><tbody>`;
                    //main table content we fill from data from the rest call
                    var main ="";
                    for (i = 0; i < results.length; i++){
                        main += "<tr><td>"+results[i].topicId+"</td><td>"+results[i].topicName+"</td><td>"+results[i].npmScore+"</td></tr>";
                    }
                    var tblbottom = "</tbody></table>";
                    var tbl = tbltop + main + tblbottom;
                    document.getElementById("surveyTopicsWithNPM").innerHTML = tbl;
                }
            };
            xmlhttp.send();
        }
        window.onload = function(){
            loadResults();
        }
    </script>
</head>
<body>
<nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="/index">Customer Satisfaction Survey</a>
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" href="/index">Home</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/createSurvey">Create Survey</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/submitSurvey">Submit Survey</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/surveyAnswers">Survey Answers</a>
        </li>
        <li class="nav-item active">
            <a class="nav-link" href="/surveyTopics">Survey Topics<span class="sr-only">(current)</span></a>
        </li>
    </ul>
</nav>

<main role="main">
    <section class="jumbotron text-center">
        <div class="container">
            <div id="surveyTopicsWithNPM"> </div>
        </div>
    </section>
</main>

</body>
<footer class="text-muted" id="footer">
    <div class="container">
        <p>Customer Satisfaction Survey &copy; Bootstrap</p>
    </div>
</footer>
</html>